---
const { obj } = Astro.props;

const regiones = [
  {
    "codigo": "15",
    "region": "Arica y Parinacota",
    "capital": "Arica"
  },
  {
    "codigo": "01",
    "region": "Tarapacá",
    "capital": "Iquique"
  },
  {
    "codigo": "02",
    "region": "Antofagasta",
    "capital": "Antofagasta"
  },
  {
    "codigo": "03",
    "region": "Atacama",
    "capital": "Copiapó"
  },
  {
    "codigo": "04",
    "region": "Coquimbo",
    "capital": "La Serena"
  },
  {
    "codigo": "05",
    "region": "Valparaíso",
    "capital": "Valparaíso"
  },
  {
    "codigo": "13",
    "region": "Metropolitana de Santiago",
    "capital": "Santiago"
  },
  {
    "codigo": "06",
    "region": "Libertador General Bernardo O’Higgins",
    "capital": "Rancagua"
  },
  {
    "codigo": "07",
    "region": "Maule",
    "capital": "Talca"
  },
  {
    "codigo": "16",
    "region": "Ñuble",
    "capital": "Chillán"
  },
  {
    "codigo": "08",
    "region": "Biobío",
    "capital": "Concepción"
  },
  {
    "codigo": "09",
    "region": "La Araucanía",
    "capital": "Temuco"
  },
  {
    "codigo": "14",
    "region": "Los Ríos",
    "capital": "Valdivia"
  },
  {
    "codigo": "10",
    "region": "Los Lagos",
    "capital": "Puerto Montt"
  },
  {
    "codigo": "11",
    "region": "Aysén del General Carlos Ibáñez del Campo",
    "capital": "Coyhaique"
  },
  {
    "codigo": "12",
    "region": "Magallanes y de la Antártica Chilena",
    "capital": "Punta Arenas"
  }
];


---
<div class="box">
  <div class="field">
    <label class="label" for="region">Región</label>
    <div class="control">
      <div>
        <select id="region" name="region" class="form-select" required data-region={obj.region}>
          <option value="">Seleccione una opción</option>
          {regiones.map((region, index) => (
            <option value={index + 1}>{region.region}</option>
          ))}

        </select>
      </div>
    </div>
  </div>

  <div class="field">
    <label class="label" for="comuna">Comuna</label>
    <div class="input-group flex-nowrap">
      <input type="text" id="comuna" name="comuna" class="form-control" placeholder="Comuna" value={obj.comuna}  required autocomplete="off"/>
    </div>
  </div>

  <div class="field">
    <label class="label" for="direccion">Dirección</label>
    <div class="input-group flex-nowrap">
      <span class="input-group-text" id="addon-wrapping"><img src="/static/assets/img/info.svg" alt=""/></span>
      <input type="text" id="direccion" name="direccion" class="form-control" placeholder="Ej. Avda. Libertador Bernardo O´Higgins 1825" value={obj.direccion}  required autocomplete="off"/>
    </div>
  </div>
  
  <div class="mt-3 form-check">
    
    {(obj.hasOwnProperty('declaraciondireccion') === false || obj.declaraciondireccion === null) && 
    <input id="declaraciondireccion" type="checkbox" class="form-check-input" name="declaraciondireccion" />
    }

    {obj.declaraciondireccion === 'on' && 
      <input id="declaraciondireccion" type="checkbox" class="form-check-input" name="declaraciondireccion" checked/>
    }
    

    <label class="form-check-label" for="declaraciondireccion">Declaro que la información entregada es fidedigna y en caso de demostrar lo contrario la matrícula será cancelada
    </label>
  </div>

  {obj.declaraciondireccion === null && 
    <div>
      <p class="alert alert-danger">
        Debe declarar que la información entregada es fidedigna.
      </p>
    </div>
  }

</div>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const select = document.getElementById('region') as HTMLInputElement;
    select.value = select.dataset.region as string;
  });
</script>